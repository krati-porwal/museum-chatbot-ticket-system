{% extends "base.html" %}

{% block title %}AI Chatbot - MuseumHub{% endblock %}

{% block content %}
<div class="chatbot-container">
    <h2 class="mb-3"><i class="fas fa-robot"></i> AI Chatbot</h2>
    <div id="chat-messages" class="chat-messages"></div>
    <form id="chat-form" class="chat-input" autocomplete="off">
        <input type="text" id="user-input" placeholder="Type your message..." autocomplete="off" required />
        <button type="submit" class="modern-btn primary"><i class="fas fa-paper-plane"></i></button>
    </form>
</div>
<script>
// Simple AJAX chat logic
const chatForm = document.getElementById('chat-form');
const chatMessages = document.getElementById('chat-messages');

function appendMessage(text, sender) {
    const msg = document.createElement('div');
    msg.className = 'message ' + sender;
    msg.innerText = text;
    chatMessages.appendChild(msg);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

chatForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const input = document.getElementById('user-input');
    const userText = input.value;
    appendMessage(userText, 'user');
    input.value = '';
    appendMessage('...', 'bot');
    const response = await fetch('/chatbot', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: userText })
    });
    const data = await response.json();
    chatMessages.lastChild.remove();
    appendMessage(data.response, 'bot');
});
</script>
{% endblock %}
